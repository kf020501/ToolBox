# WinEventLogAnalyzer

このPowerShellスクリプトは、Windowsイベントログファイルを抽出し、指定されたディレクトリにExcelファイルとして保存します。  
各イベントログファイルは個別のシートに書き込まれ、イベントの詳細が含まれます。
※ 現時点では全然Analyzeしてないけど、そのうち頑張る！

## 使用方法

1. **PowerShellスクリプトの実行**
   - スクリプトを実行するには、管理者権限のPowerShellウィンドウを開きます。
   - 以下のコマンドを使用して、スクリプトを実行します。
     ```powershell
     .\Export-EventLogsToExcel.ps1 "C:\Path\To\Log1.evtx" "C:\Path\To\Log2.evtx"
     ```

2. **パラメータ**
   - `$Args`: コマンドライン引数として複数のイベントログファイルパスを渡します。

3. **Excelファイルの出力**
   - スクリプトは指定された各イベントログファイルに対応するシートを作成し、イベント情報をExcelに書き込みます。
   - 最終的なExcelファイルは、指定された最初のログファイルと同じディレクトリに `WinEventLog_YYYYMMDD.xlsx` という形式で保存されます。

## スクリプトの詳細

- **Excelの準備**
  - Excelを非表示モードで起動し、警告メッセージの表示を有効にしています。
  - 新しいExcelワークブックが作成され、各イベントログの内容がそれぞれのシートに書き込まれます。

- **イベントログの処理**
  - 各イベントログファイルの内容が抽出されます。
  - 各ファイルに対して、イベントのプロパティ名を列ヘッダーとして、イベントデータが行ごとに書き込まれます。
  - Excelシートは適切に自動サイズ調整されます。

- **Excelファイルの保存**
  - 保存されたExcelファイルは、イベントログファイルと同じディレクトリに作成され、ファイル名には実行日が含まれます。

## 注意事項

- スクリプトの実行には、PowerShellの実行ポリシーが `RemoteSigned` もしくは `Unrestricted` に設定されている必要があります。
- スクリプトの実行には、Microsoft Excelがインストールされている必要があります。
